// Copyright 2025, Command Line Inc.
// SPDX-License-Identifier: Apache-2.0

export type AppLanguage = "en" | "zh-CN";

export const DefaultAppLanguage: AppLanguage = "en";

export function normalizeAppLanguage(lang?: string | null): AppLanguage {
    if (!lang) return DefaultAppLanguage;
    const normalized = String(lang).trim();
    if (!normalized) return DefaultAppLanguage;

    const lower = normalized.toLowerCase();
    if (lower === "zh-cn" || lower === "zh" || lower.startsWith("zh-")) {
        return "zh-CN";
    }
    return "en";
}

export function getAppLanguageFromSettings(settings?: SettingsType | null): AppLanguage {
    return normalizeAppLanguage(settings?.["app:language"]);
}

const en = {
    // Common
    "common.adding": "Adding...",
    "common.cancel": "Cancel",
    "common.close": "Close",
    "common.default": "Default",
    "common.defaultWithValue": "Default ({value})",
    "common.delete": "Delete",
    "common.deleting": "Deleting...",
    "common.edit": "Edit",
    "common.loading": "Loading...",
    "common.reset": "Reset",
    "common.save": "Save",
    "common.saving": "Saving...",
    "common.unknown": "Unknown",
    "common.openDevTools": "Open DevTools",
    "common.closeDevTools": "Close DevTools",

    // Settings
    "settings.language": "Language",
    "settings.language.description": "Changes take effect immediately.",
    "settings.language.english": "English",
    "settings.language.chinese": "中文",
    "settings.remoteTmuxResume": "Remote Terminal Resume",
    "settings.remoteTmuxResume.description":
        "When enabled, TideTerm will use tmux on remote terminals (SSH/WSL) when available so sessions can resume after reconnects. If tmux is not installed, TideTerm will fall back to a normal shell and show an install hint.",
    "settings.remoteTmuxResume.toggle": "Auto-resume remote terminals with tmux (recommended)",

    // Workspace / widgets
    "workspace.localWaveApps": "Local Apps",
    "workspace.settingsAndHelp": "Settings & Help",
    "workspace.appsLabel": "apps",
    "workspace.settingsLabel": "settings",
    "workspace.menu.settings": "Settings",
    "workspace.menu.tips": "Tips",
    "workspace.menu.secrets": "Secrets",
    "workspace.menu.help": "Help",

    // File / directory context menu
    "filemenu.newFile": "New File",
    "filemenu.newFolder": "New Folder",
    "filemenu.rename": "Rename",
    "filemenu.copyFileName": "Copy File Name",
    "filemenu.copyFullFileName": "Copy Full File Name",
    "filemenu.copyFileNameShellQuoted": "Copy File Name (Shell Quoted)",
    "filemenu.copyFullFileNameShellQuoted": "Copy Full File Name (Shell Quoted)",
    "filemenu.openFileInDefaultApplication": "Open File in Default Application",
    "filemenu.revealInFinder": "Reveal in Finder",
    "filemenu.revealInExplorer": "Reveal in Explorer",
    "filemenu.revealInFileManager": "Reveal in File Manager",
    "filemenu.downloadFile": "Download File",
    "filemenu.openPreviewInNewBlock": "Open Preview in New Block",
    "filemenu.openTerminalInNewBlock": "Open Terminal in New Block",

    // App context menu
    "contextmenu.openClipboardUrl": "Open Clipboard URL ({host})",
    "contextmenu.openCurrentDirectoryInNewBlock": "Open Current Directory in New Block",

    // Block header context menu
    "blockmenu.magnifyBlock": "Magnify Block",
    "blockmenu.unmagnifyBlock": "Un-Magnify Block",
    "blockmenu.copyBlockId": "Copy BlockId",
    "blockmenu.closeBlock": "Close Block",

    // Tab context menu
    "tabmenu.pinTab": "Pin Tab",
    "tabmenu.unpinTab": "Unpin Tab",
    "tabmenu.renameTab": "Rename Tab",
    "tabmenu.copyTabId": "Copy TabId",
    "tabmenu.backgrounds": "Backgrounds",
    "tabmenu.closeTab": "Close Tab",

    // Terminal settings menu
    "termmenu.themes": "Themes",
    "termmenu.fontSize": "Font Size",
    "termmenu.transparency": "Transparency",
    "termmenu.transparentBackground": "Transparent Background",
    "termmenu.noTransparency": "No Transparency",
    "termmenu.allowBracketedPasteMode": "Allow Bracketed Paste Mode",
    "termmenu.forceRestartController": "Force Restart Controller",
    "termmenu.clearOutputOnRestart": "Clear Output On Restart",
    "termmenu.runOnStartup": "Run On Startup",
    "termmenu.closeToolbar": "Close Toolbar",
    "termmenu.debugConnection": "Debug Connection",
    "termmenu.debugConnectionInfo": "Info",
    "termmenu.debugConnectionVerbose": "Verbose",

    // Terminal sessions (multi-term within one block)
    "term.sessions.new": "New Terminal",
    "term.sessions.showList": "Show Terminal List",
    "term.sessions.hideList": "Hide Terminal List",
    "term.sessions.listTitle": "Terminals",
    "term.sessions.kill": "Kill Terminal",
    "term.sessions.closeBlock": "Close Terminal Block",
    "term.sessions.terminalWithIndex": "Terminal {index}",

    // Tmux sessions (remote terminal management)
    "term.tmuxSessions.openTitle": "Manage tmux sessions",
    "term.tmuxSessions.title": "tmux Sessions",
    "term.tmuxSessions.refresh": "Refresh",
    "term.tmuxSessions.loading": "Loading tmux sessions...",
    "term.tmuxSessions.empty": "No tmux sessions found.",
    "term.tmuxSessions.attached": "Attached",
    "term.tmuxSessions.detached": "Detached",
    "term.tmuxSessions.unmanaged": "external",
    "term.tmuxSessions.current": "This Block",
    "term.tmuxSessions.attach": "Attach",
    "term.tmuxSessions.forceAttach": "Force Attach",
    "term.tmuxSessions.rename": "Rename",
    "term.tmuxSessions.renameEdit": "Edit Name",
    "term.tmuxSessions.clearName": "Clear Name",
    "term.tmuxSessions.kill": "Kill",
    "term.tmuxSessions.killAll": "Kill All",
    "term.tmuxSessions.columns.name": "Session",
    "term.tmuxSessions.columns.windows": "Windows",
    "term.tmuxSessions.columns.attached": "Status",
    "term.tmuxSessions.columns.recent": "Recent Activity",
    "term.tmuxSessions.columns.actions": "Actions",
    "term.tmuxSessions.activity.justNow": "just now",
    "term.tmuxSessions.activity.minutesAgo": "{count}m ago",
    "term.tmuxSessions.activity.hoursAgo": "{count}h ago",
    "term.tmuxSessions.activity.daysAgo": "{count}d ago",
    "term.tmuxSessions.activity.unknown": "unknown",
    "term.tmuxSessions.errors.localUnsupported": "tmux session list is only available for remote connections.",
    "term.tmuxSessions.confirm.forceAttach": "Force attach will disconnect other clients from this session. Continue?",
    "term.tmuxSessions.confirm.attach": "This session is already attached. Attach anyway?",
    "term.tmuxSessions.confirm.kill": "Kill this tmux session?",
    "term.tmuxSessions.confirm.killRisk": "This session looks external or currently attached. Kill anyway?",
    "term.tmuxSessions.confirm.killAll": "Kill all tmux sessions for this connection?",
    "term.tmuxSessions.prompt.alias": "Display name",

    // Web view settings menu
    "webviewmenu.copyUrlToClipboard": "Copy URL to Clipboard",
    "webviewmenu.setBlockHomepage": "Set Block Homepage",
    "webviewmenu.setDefaultHomepage": "Set Default Homepage",
    "webviewmenu.userAgentType": "User Agent Type",
    "webviewmenu.userAgentDefault": "Default",
    "webviewmenu.userAgentMobileIphone": "Mobile: iPhone",
    "webviewmenu.userAgentMobileAndroid": "Mobile: Android",
    "webviewmenu.hideNavigation": "Hide Navigation",
    "webviewmenu.unhideNavigation": "Un-Hide Navigation",
    "webviewmenu.setZoomFactor": "Set Zoom Factor",
    "webviewmenu.clearHistory": "Clear History",
    "webviewmenu.clearCookiesAndStorage": "Clear Cookies and Storage (All Web Widgets)",

    // Preview settings menu
    "previewmenu.goToBookmark": "Go to {label} ({path})",
    "previewmenu.copyFullPath": "Copy Full Path",
    "previewmenu.editorFontSize": "Editor Font Size",
    "previewmenu.saveFile": "Save File",
    "previewmenu.revertFile": "Revert File",
    "previewmenu.wordWrap": "Word Wrap",

    // Sysinfo settings menu
    "sysinfomenu.plotType": "Plot Type",

    // Tsunami settings menu
    "tsunamimenu.stopWaveApp": "Stop WaveApp",
    "tsunamimenu.restartWaveApp": "Restart WaveApp",
    "tsunamimenu.restartWaveAppForceRebuild": "Restart WaveApp and Force Rebuild",
    "tsunamimenu.remixWaveAppInBuilder": "Remix WaveApp in Builder",

    // WaveAI (AI panel) context menu
    "aipanelmenu.newChat": "New Chat",
    "aipanelmenu.maxOutputTokens": "Max Output Tokens",
    "aipanelmenu.configureModes": "Configure Modes",
    "aipanelmenu.hideTideTermAI": "Hide TideTerm AI",
    "aipanelmenu.tokens.1kDevTesting": "1k (Dev Testing)",
    "aipanelmenu.tokens.4k": "4k",
    "aipanelmenu.tokens.16kPro": "16k (Pro)",
    "aipanelmenu.tokens.24k": "24k",
    "aipanelmenu.tokens.64kPro": "64k (Pro)",

    // Workspace widgets context menu
    "workspace.menu.editWidgetsJson": "Edit widgets.json",

    // Builder context menu
    "buildermenu.addToContext": "Add to Context",
    "buildermenu.publishApp": "Publish App",
    "buildermenu.switchApp": "Switch App",
    "buildermenu.renameFile": "Rename File",
    "buildermenu.deleteFile": "Delete File",

    // WaveConfig
    "waveconfig.configFiles": "Config Files",
    "waveconfig.deprecated": "deprecated",
    "waveconfig.file.general": "General",
    "waveconfig.file.connections": "Connections",
    "waveconfig.file.sidebarWidgets": "Sidebar Widgets",
    "waveconfig.file.waveAiModes": "AI Modes",
    "waveconfig.file.tabBackgrounds": "Tab Backgrounds",
    "waveconfig.file.secrets": "Secrets",
    "waveconfig.file.presets": "Presets",
    "waveconfig.file.aiPresets": "AI Presets",
    "waveconfig.unsavedChanges": "Unsaved changes",
    "waveconfig.visual": "Visual",
    "waveconfig.rawJson": "Raw JSON",
    "waveconfig.viewDocumentation": "View documentation",
    "waveconfig.saveWithShortcut": "Save ({shortcut})",
    "waveconfig.connections.description.sshHosts": "SSH hosts",
    "waveconfig.connections.description.sshHostsAndWslDistros": "SSH hosts and WSL distros",
    "waveconfig.waveAiModes.description": "Local models and BYOK",

    // Secrets
    "secrets.noSecrets": "No Secrets",
    "secrets.addToGetStarted": "Add a secret to get started",
    "secrets.addNewSecret": "Add New Secret",
    "secrets.cliAccess": "CLI Access",
    "secrets.addNewSecret.title": "Add New Secret",
    "secrets.secretName": "Secret Name",
    "secrets.secretName.help":
        "Must start with a letter and contain only letters, numbers, and underscores.",
    "secrets.secretName.placeholder": "MY_SECRET_NAME",
    "secrets.secretValue": "Secret Value",
    "secrets.secretValue.placeholder": "Enter secret value...",
    "secrets.secretValue.placeholderNew": "Enter new secret value...",
    "secrets.addSecret": "Add Secret",
    "secrets.currentValueNotShown":
        "The current secret value is not shown by default for security purposes.",
    "secrets.show": "Show",
    "secrets.showSecret": "Show Secret",
    "secrets.loadingSecrets": "Loading secrets...",
    "secrets.deleteThisSecret": "Delete this secret",

    // MCP Servers
    "waveconfig.file.mcpServers": "MCP Servers",
    "waveconfig.mcpServers.description": "Manage MCP servers for AI tools",
    "mcp.noServers": "No MCP Servers",
    "mcp.addToGetStarted": "Add an MCP server or import from installed AI applications",
    "mcp.addServer": "Add Server",
    "mcp.editServer": "Edit Server",
    "mcp.importFromApps": "Import from Apps",
    "mcp.loading": "Loading MCP configuration...",
    "mcp.serverCount": "{count} server(s)",
    "mcp.syncAll": "Sync All",
    "mcp.syncAll.tooltip": "Sync all servers to their enabled apps",
    "mcp.import": "Import",
    "mcp.importSuccess": "Successfully imported {count} server(s)",
    "mcp.importNoServers": "No new servers to import",
    "mcp.syncSuccess": "All servers synced successfully",
    "mcp.deleteConfirm": "Are you sure you want to delete this server?",
    "mcp.serverId": "Server ID",
    "mcp.serverId.help": "Unique identifier for this server (e.g., my-mcp-server)",
    "mcp.serverName": "Display Name",
    "mcp.transportType": "Transport Type",
    "mcp.command": "Command",
    "mcp.args": "Arguments",
    "mcp.args.help": "Space-separated arguments for the command",
    "mcp.env": "Environment Variables",
    "mcp.env.help": "One variable per line in KEY=value format",
    "mcp.url": "URL",
    "mcp.description": "Description",
    "mcp.description.placeholder": "Brief description of this server",
    "mcp.enabledApps": "Enabled Apps",
    "mcp.enabledApps.help": "Select which apps should use this MCP server",
    "mcp.installedApps": "Installed Apps",
    "mcp.warning": "Important: Please clear all existing MCP servers in the AI apps first, then configure them here. Otherwise synchronization may fail.",

    // App menu (Electron)
    "menu.workspace": "Workspace",
    "menu.createWorkspace": "Create Workspace",
    "menu.newWindow": "New Window",
    "menu.newWaveAppBuilderWindow": "New App Builder Window",
    "menu.closeWindow": "Close",
    "menu.reloadWindow": "Reload Window",
    "menu.reloadTab": "Reload Tab",
    "menu.relaunchAllWindows": "Relaunch All Windows",
    "menu.clearTabCache": "Clear Tab Cache",
    "menu.toggleDevTools": "Toggle DevTools",
    "menu.resetZoom": "Reset Zoom",
    "menu.zoomIn": "Zoom In",
    "menu.zoomOut": "Zoom Out",
    "menu.launchOnFullScreen": "Launch On Full Screen",
    "menu.on": "On",
    "menu.off": "Off",
    "menu.aboutWaveTerminal": "About TideTerm",
    "menu.checkForUpdates": "Check for Updates",
    "menu.undo": "Undo",
    "menu.redo": "Redo",
    "menu.cut": "Cut",
    "menu.copy": "Copy",
    "menu.paste": "Paste",
    "menu.pasteAndMatchStyle": "Paste and Match Style",
    "menu.delete": "Delete",
    "menu.selectAll": "Select All",
    "menu.services": "Services",
    "menu.hide": "Hide",
    "menu.hideOthers": "Hide Others",
    "menu.quit": "Quit",
    "menu.file": "File",
    "menu.edit": "Edit",
    "menu.view": "View",
    "menu.window": "Window",
    "menu.windowTitle": "Window Title",
    "menu.showWindow": "Show Window",
    "menu.renameWindow": "Rename Window…",
    "menu.restoreAutoWindowTitle": "Use Automatic Title",
    "menu.fullscreen": "Full Screen",

    // Window title
    "windowtitle.rename.title": "Rename Window",
    "windowtitle.rename.placeholder": "Enter window name…",

    // Proxy
    "proxy.viewName": "API Proxy",
    "proxy.title": "API Proxy",
    "proxy.start": "Start",
    "proxy.stop": "Stop",
    "proxy.status.running": "Running",
    "proxy.status.stopped": "Stopped",
    "proxy.port": "Port",
    "proxy.portChangeRestarts": "Changing the port will restart the proxy.",
    "proxy.uptime": "Uptime",
    "proxy.channels": "Channels",
    "proxy.copyAddress": "Copy API URL",
    "proxy.copyAddress.copied": "Copied",
    "proxy.serviceNotRunning": "Service not running",
    "proxy.tab.messages": "Claude",
    "proxy.tab.responses": "Codex",
    "proxy.tab.gemini": "Gemini",
    "proxy.tab.metrics": "Metrics",
    "proxy.tab.history": "History",
    "proxy.channelCount": "{count} channel(s)",
    "proxy.addChannel": "Add Channel",
    "proxy.addFirstChannel": "Add Your First Channel",
    "proxy.noChannels": "No channels configured",
    "proxy.sync.syncChannels": "Sync channels",
    "proxy.sync.syncFromLocal": "Sync from Local",
    "proxy.sync.confirmOverwriteRemote":
        "This will overwrite the remote proxy channels (including API keys) on {connection}. Continue?",
    "proxy.sync.syncedAll": "Synced all channels to {connection}.",
    "proxy.sync.noLocalChannels": "No local {tab} channels configured. Add a channel first.",
    "proxy.sync.syncedChannels": "Synced {count} {tab} channel(s) to {connection}.",
    "proxy.dock.minimize": "Minimize",
    "proxy.dock.running": "API Proxy ({connection}) running on port {port}",
    "proxy.dock.stopped": "API Proxy ({connection}) stopped",
    "proxy.dock.disconnected": "API Proxy ({connection}) disconnected",
    "proxy.dock.unknown": "API Proxy ({connection}) status unavailable",
    "proxy.editChannel": "Edit Channel",
    "proxy.deleteChannel": "Delete Channel",
    "proxy.testConnection": "Test connection",
    "proxy.latency": "Latency: {ms}ms",
    "proxy.channel.channelWithIndex": "Channel {index}",
    "proxy.channel.name": "Name",
    "proxy.channel.serviceType": "Service Type",
    "proxy.channel.baseUrl": "Base URL",
    "proxy.channel.backupUrls": "Backup URLs",
    "proxy.channel.configuredCount": "{count} configured",
    "proxy.channel.apiKeys": "API Keys",
    "proxy.channel.apiKeysSummary": "{count} key(s) - {sample}",
    "proxy.channel.apiKeysSummaryEnabled": "{enabled} enabled / {total} total - {sample}",
    "proxy.channel.apiKeysAllPaused": "{total} key(s) configured (all paused)",
    "proxy.channel.noneConfigured": "None configured",
    "proxy.channel.priority": "Priority",
    "proxy.channel.status": "Status",
    "proxy.channel.active": "Active",
    "proxy.channel.suspended": "Suspended",
    "proxy.channel.disabled": "Disabled",
    "proxy.channel.enableHint": "Enable this channel",
    "proxy.channel.disableHint": "Disable this channel",
    "proxy.channel.modelMapping": "Model Mapping",
    "proxy.channel.modelMappingSummary": "{count} rule(s)",
    "proxy.channel.description": "Description",
    "proxy.channel.lowQuality": "Low quality channel",
    "proxy.channel.authType": "Auth Type",
    "proxy.channel.authTypeDefault": "Default (based on service type)",
    "proxy.channel.authTypeBearer": "Bearer Token",
    "proxy.channel.authTypeBoth": "Both (API key + Bearer)",
    "proxy.channel.dragToReorder": "Drag to reorder",
    "proxy.metrics.title": "Performance Metrics",
    "proxy.metrics.refresh": "Refresh",
    "proxy.metrics.totalRequests": "Total Requests",
    "proxy.metrics.successRate": "Success Rate",
    "proxy.metrics.successful": "Successful",
    "proxy.metrics.failed": "Failed",
    "proxy.metrics.requestDistribution": "Request Distribution",
    "proxy.metrics.successRateByChannel": "Success Rate by Channel",
    "proxy.metrics.avgLatency": "Average Latency",
    "proxy.metrics.tokenUsage": "Token Usage",
    "proxy.metrics.inputTokens": "Input Tokens",
    "proxy.metrics.outputTokens": "Output Tokens",
    "proxy.circuitBreaker.title": "Circuit Breaker Status",
    "proxy.circuitBreaker.healthy": "All circuits healthy",
    "proxy.circuitBreaker.failures": "{count} consecutive failures",
    "proxy.circuitBreaker.reset": "Reset circuit breaker",
    "proxy.form.basicInfo": "Basic Information",
    "proxy.form.quickPick": "Quick Picks",
    "proxy.form.authentication": "Authentication",
    "proxy.form.advanced": "Advanced",
    "proxy.form.addApiKey": "Add API Key",
    "proxy.form.addBackupUrl": "Add backup URL",
    "proxy.form.addMapping": "Add mapping",
    "proxy.form.sourceModel": "Source model",
    "proxy.form.targetModel": "Target model",
    "proxy.form.optional": "(Optional)",
    "proxy.form.channelNamePlaceholder": "Channel name",
    "proxy.form.apiKeyPlaceholder": "Enter API key",
    "proxy.form.apiKeyEnable": "Enable key",
    "proxy.form.apiKeyDisable": "Pause key",
    "proxy.form.descriptionPlaceholder": "Channel description (optional)",
    "proxy.form.saveChanges": "Save Changes",
    "proxy.noData": "No data available",
    "proxy.history.loading": "Loading history...",
    "proxy.history.recordCount": "{count} records",
    "proxy.history.retentionHint": "Retains last {hours} hours",
    "proxy.history.filterChannel": "Channel: {channel}",
    "proxy.history.filterStatus.label": "Status filter",
    "proxy.history.filterStatus.all": "All",
    "proxy.history.filterStatus.error": "Errors",
    "proxy.history.filterStatus.success": "Success",
    "proxy.history.clear": "Clear",
    "proxy.history.emptyTitle": "No request history available",
    "proxy.history.emptyHint": "Requests will appear here as they are made",
    "proxy.history.col.status": "Status",
    "proxy.history.col.details": "Details",
    "proxy.history.col.time": "Time",
    "proxy.history.col.type": "Type",
    "proxy.history.col.channel": "Channel",
    "proxy.history.col.model": "Model",
    "proxy.history.col.tokens": "Tokens",
    "proxy.history.col.latency": "Latency",
    "proxy.history.filterByChannel": "Filter by channel: {channelId}",
    "proxy.history.viewErrorDetails": "View error details",
    "proxy.history.detailsTitle": "Error Details",
    "proxy.history.detailsSummary": "Summary",
    "proxy.history.detailsTime": "Time",
    "proxy.history.detailsChannel": "Channel",
} as const;

export type I18nKey = keyof typeof en;

const zhCN: Record<I18nKey, string> = {
    // Common
    "common.adding": "正在添加…",
    "common.cancel": "取消",
    "common.close": "关闭",
    "common.default": "默认",
    "common.defaultWithValue": "默认（{value}）",
    "common.delete": "删除",
    "common.deleting": "正在删除…",
    "common.edit": "编辑",
    "common.loading": "加载中…",
    "common.reset": "重置",
    "common.save": "保存",
    "common.saving": "正在保存…",
    "common.unknown": "未知",
    "common.openDevTools": "打开开发者工具",
    "common.closeDevTools": "关闭开发者工具",

    // Settings
    "settings.language": "语言",
    "settings.language.description": "切换后立即生效，无需重启。",
    "settings.language.english": "English",
    "settings.language.chinese": "中文",
    "settings.remoteTmuxResume": "远程终端续连",
    "settings.remoteTmuxResume.description":
        "启用后，远程终端（SSH/WSL）在检测到 tmux 时会自动进入 tmux，会话可在断线重连后继续（如电脑休眠/网络中断）。若未安装 tmux，则正常打开普通 shell，并提示可选安装。",
    "settings.remoteTmuxResume.toggle": "使用 tmux 自动续连远程终端（推荐）",

    // Workspace / widgets
    "workspace.localWaveApps": "本地应用",
    "workspace.settingsAndHelp": "设置与帮助",
    "workspace.appsLabel": "应用",
    "workspace.settingsLabel": "设置",
    "workspace.menu.settings": "设置",
    "workspace.menu.tips": "提示",
    "workspace.menu.secrets": "密钥",
    "workspace.menu.help": "帮助",

    // File / directory context menu
    "filemenu.newFile": "新建文件",
    "filemenu.newFolder": "新建文件夹",
    "filemenu.rename": "重命名",
    "filemenu.copyFileName": "复制文件名",
    "filemenu.copyFullFileName": "复制完整路径",
    "filemenu.copyFileNameShellQuoted": "复制文件名（Shell 引号）",
    "filemenu.copyFullFileNameShellQuoted": "复制完整路径（Shell 引号）",
    "filemenu.openFileInDefaultApplication": "用默认应用打开文件",
    "filemenu.revealInFinder": "在访达中显示",
    "filemenu.revealInExplorer": "在资源管理器中显示",
    "filemenu.revealInFileManager": "在文件管理器中显示",
    "filemenu.downloadFile": "下载文件",
    "filemenu.openPreviewInNewBlock": "在新块中打开预览",
    "filemenu.openTerminalInNewBlock": "在新块中打开终端",

    // App context menu
    "contextmenu.openClipboardUrl": "打开剪贴板 URL（{host}）",
    "contextmenu.openCurrentDirectoryInNewBlock": "在新块中打开当前目录",

    // Block header context menu
    "blockmenu.magnifyBlock": "放大块",
    "blockmenu.unmagnifyBlock": "取消放大块",
    "blockmenu.copyBlockId": "复制 BlockId",
    "blockmenu.closeBlock": "关闭块",

    // Tab context menu
    "tabmenu.pinTab": "固定标签页",
    "tabmenu.unpinTab": "取消固定标签页",
    "tabmenu.renameTab": "重命名标签页",
    "tabmenu.copyTabId": "复制 TabId",
    "tabmenu.backgrounds": "背景",
    "tabmenu.closeTab": "关闭标签页",

    // Terminal settings menu
    "termmenu.themes": "主题",
    "termmenu.fontSize": "字体大小",
    "termmenu.transparency": "透明度",
    "termmenu.transparentBackground": "透明背景",
    "termmenu.noTransparency": "无透明",
    "termmenu.allowBracketedPasteMode": "允许括号粘贴模式",
    "termmenu.forceRestartController": "强制重启控制器",
    "termmenu.clearOutputOnRestart": "重启时清空输出",
    "termmenu.runOnStartup": "启动时运行",
    "termmenu.closeToolbar": "关闭工具栏",
    "termmenu.debugConnection": "连接调试",
    "termmenu.debugConnectionInfo": "信息",
    "termmenu.debugConnectionVerbose": "详细",

    // Terminal sessions（一个终端块内多个终端）
    "term.sessions.new": "新建终端",
    "term.sessions.showList": "显示终端列表",
    "term.sessions.hideList": "隐藏终端列表",
    "term.sessions.listTitle": "终端",
    "term.sessions.kill": "结束终端",
    "term.sessions.closeBlock": "关闭终端块",
    "term.sessions.terminalWithIndex": "终端 {index}",

    // Tmux sessions（远程终端管理）
    "term.tmuxSessions.openTitle": "管理 tmux 会话",
    "term.tmuxSessions.title": "tmux 会话",
    "term.tmuxSessions.refresh": "刷新",
    "term.tmuxSessions.loading": "正在加载 tmux 会话...",
    "term.tmuxSessions.empty": "没有找到 tmux 会话。",
    "term.tmuxSessions.attached": "已连接",
    "term.tmuxSessions.detached": "未连接",
    "term.tmuxSessions.unmanaged": "外部",
    "term.tmuxSessions.current": "当前块",
    "term.tmuxSessions.attach": "接入",
    "term.tmuxSessions.forceAttach": "强制接入",
    "term.tmuxSessions.rename": "重命名",
    "term.tmuxSessions.renameEdit": "编辑名称",
    "term.tmuxSessions.clearName": "清除名称",
    "term.tmuxSessions.kill": "结束",
    "term.tmuxSessions.killAll": "全部结束",
    "term.tmuxSessions.columns.name": "会话",
    "term.tmuxSessions.columns.windows": "窗口",
    "term.tmuxSessions.columns.attached": "状态",
    "term.tmuxSessions.columns.recent": "最近活跃",
    "term.tmuxSessions.columns.actions": "操作",
    "term.tmuxSessions.activity.justNow": "刚刚",
    "term.tmuxSessions.activity.minutesAgo": "{count} 分钟前",
    "term.tmuxSessions.activity.hoursAgo": "{count} 小时前",
    "term.tmuxSessions.activity.daysAgo": "{count} 天前",
    "term.tmuxSessions.activity.unknown": "未知",
    "term.tmuxSessions.errors.localUnsupported": "tmux 会话列表仅支持远程连接。",
    "term.tmuxSessions.confirm.forceAttach": "强制接入将断开其他客户端，继续？",
    "term.tmuxSessions.confirm.attach": "该会话已被连接，仍要接入吗？",
    "term.tmuxSessions.confirm.kill": "确定结束该 tmux 会话？",
    "term.tmuxSessions.confirm.killRisk": "该会话可能是外部或已连接，仍要结束吗？",
    "term.tmuxSessions.confirm.killAll": "确定结束此连接上的所有 tmux 会话？",
    "term.tmuxSessions.prompt.alias": "显示名称",

    // Web view settings menu
    "webviewmenu.copyUrlToClipboard": "复制 URL 到剪贴板",
    "webviewmenu.setBlockHomepage": "设置块主页",
    "webviewmenu.setDefaultHomepage": "设置默认主页",
    "webviewmenu.userAgentType": "User Agent 类型",
    "webviewmenu.userAgentDefault": "默认",
    "webviewmenu.userAgentMobileIphone": "移动端：iPhone",
    "webviewmenu.userAgentMobileAndroid": "移动端：Android",
    "webviewmenu.hideNavigation": "隐藏导航",
    "webviewmenu.unhideNavigation": "显示导航",
    "webviewmenu.setZoomFactor": "设置缩放比例",
    "webviewmenu.clearHistory": "清除历史记录",
    "webviewmenu.clearCookiesAndStorage": "清除 Cookie 和存储（所有 Web 小组件）",

    // Preview settings menu
    "previewmenu.goToBookmark": "前往 {label}（{path}）",
    "previewmenu.copyFullPath": "复制完整路径",
    "previewmenu.editorFontSize": "编辑器字体大小",
    "previewmenu.saveFile": "保存文件",
    "previewmenu.revertFile": "还原文件",
    "previewmenu.wordWrap": "自动换行",

    // Sysinfo settings menu
    "sysinfomenu.plotType": "图表类型",

    // Tsunami settings menu
    "tsunamimenu.stopWaveApp": "停止 WaveApp",
    "tsunamimenu.restartWaveApp": "重启 WaveApp",
    "tsunamimenu.restartWaveAppForceRebuild": "重启 WaveApp 并强制重建",
    "tsunamimenu.remixWaveAppInBuilder": "在 Builder 中 Remix WaveApp",

    // WaveAI (AI panel) context menu
    "aipanelmenu.newChat": "新建对话",
    "aipanelmenu.maxOutputTokens": "最大输出 Token",
    "aipanelmenu.configureModes": "配置模式",
    "aipanelmenu.hideTideTermAI": "隐藏 TideTerm AI",
    "aipanelmenu.tokens.1kDevTesting": "1k（开发测试）",
    "aipanelmenu.tokens.4k": "4k",
    "aipanelmenu.tokens.16kPro": "16k（Pro）",
    "aipanelmenu.tokens.24k": "24k",
    "aipanelmenu.tokens.64kPro": "64k（Pro）",

    // Workspace widgets context menu
    "workspace.menu.editWidgetsJson": "编辑 widgets.json",

    // Builder context menu
    "buildermenu.addToContext": "添加到上下文",
    "buildermenu.publishApp": "发布应用",
    "buildermenu.switchApp": "切换应用",
    "buildermenu.renameFile": "重命名文件",
    "buildermenu.deleteFile": "删除文件",

    // WaveConfig
    "waveconfig.configFiles": "配置文件",
    "waveconfig.deprecated": "已弃用",
    "waveconfig.file.general": "通用",
    "waveconfig.file.connections": "连接",
    "waveconfig.file.sidebarWidgets": "侧边栏小部件",
    "waveconfig.file.waveAiModes": "AI 模式",
    "waveconfig.file.tabBackgrounds": "标签页背景",
    "waveconfig.file.secrets": "密钥",
    "waveconfig.file.presets": "预设",
    "waveconfig.file.aiPresets": "AI 预设",
    "waveconfig.unsavedChanges": "未保存的更改",
    "waveconfig.visual": "可视化",
    "waveconfig.rawJson": "原始 JSON",
    "waveconfig.viewDocumentation": "查看文档",
    "waveconfig.saveWithShortcut": "保存（{shortcut}）",
    "waveconfig.connections.description.sshHosts": "SSH 主机",
    "waveconfig.connections.description.sshHostsAndWslDistros": "SSH 主机和 WSL 发行版",
    "waveconfig.waveAiModes.description": "本地模型和 BYOK",

    // Secrets
    "secrets.noSecrets": "暂无密钥",
    "secrets.addToGetStarted": "添加一个密钥以开始使用",
    "secrets.addNewSecret": "添加新密钥",
    "secrets.cliAccess": "命令行访问",
    "secrets.addNewSecret.title": "添加新密钥",
    "secrets.secretName": "密钥名称",
    "secrets.secretName.help": "必须以字母开头，只能包含字母、数字和下划线。",
    "secrets.secretName.placeholder": "MY_SECRET_NAME",
    "secrets.secretValue": "密钥内容",
    "secrets.secretValue.placeholder": "输入密钥内容…",
    "secrets.secretValue.placeholderNew": "输入新的密钥内容…",
    "secrets.addSecret": "添加密钥",
    "secrets.currentValueNotShown": "出于安全考虑，默认不显示当前密钥内容。",
    "secrets.show": "显示",
    "secrets.showSecret": "显示密钥",
    "secrets.loadingSecrets": "正在加载密钥…",
    "secrets.deleteThisSecret": "删除此密钥",

    // MCP Servers
    "waveconfig.file.mcpServers": "MCP 服务器",
    "waveconfig.mcpServers.description": "管理 AI 工具的 MCP 服务器",
    "mcp.noServers": "暂无 MCP 服务器",
    "mcp.addToGetStarted": "添加 MCP 服务器或从已安装的 AI 应用导入",
    "mcp.addServer": "添加服务器",
    "mcp.editServer": "编辑服务器",
    "mcp.importFromApps": "从应用导入",
    "mcp.loading": "正在加载 MCP 配置…",
    "mcp.serverCount": "{count} 个服务器",
    "mcp.syncAll": "同步全部",
    "mcp.syncAll.tooltip": "将所有服务器同步到启用的应用",
    "mcp.import": "导入",
    "mcp.importSuccess": "成功导入 {count} 个服务器",
    "mcp.importNoServers": "没有新服务器可导入",
    "mcp.syncSuccess": "所有服务器同步成功",
    "mcp.deleteConfirm": "确定要删除此服务器吗？",
    "mcp.serverId": "服务器 ID",
    "mcp.serverId.help": "此服务器的唯一标识符（例如：my-mcp-server）",
    "mcp.serverName": "显示名称",
    "mcp.transportType": "传输类型",
    "mcp.command": "命令",
    "mcp.args": "参数",
    "mcp.args.help": "命令参数，用空格分隔",
    "mcp.env": "环境变量",
    "mcp.env.help": "每行一个变量，格式为 KEY=value",
    "mcp.url": "URL",
    "mcp.description": "描述",
    "mcp.description.placeholder": "此服务器的简要描述",
    "mcp.enabledApps": "启用的应用",
    "mcp.enabledApps.help": "选择哪些应用应使用此 MCP 服务器",
    "mcp.installedApps": "已安装的应用",
    "mcp.warning": "重要提示：请先清空各 AI 应用中已有的 MCP 服务器配置，然后在此处进行设置，否则同步可能会失败。",

    // App menu (Electron)
    "menu.workspace": "工作区",
    "menu.createWorkspace": "新建工作区",
    "menu.newWindow": "新建窗口",
    "menu.newWaveAppBuilderWindow": "新建 App Builder 窗口",
    "menu.closeWindow": "关闭",
    "menu.reloadWindow": "重新加载窗口",
    "menu.reloadTab": "重新加载标签页",
    "menu.relaunchAllWindows": "重新启动所有窗口",
    "menu.clearTabCache": "清除标签页缓存",
    "menu.toggleDevTools": "切换开发者工具",
    "menu.resetZoom": "重置缩放",
    "menu.zoomIn": "放大",
    "menu.zoomOut": "缩小",
    "menu.launchOnFullScreen": "启动时全屏",
    "menu.on": "开",
    "menu.off": "关",
    "menu.aboutWaveTerminal": "关于 TideTerm",
    "menu.checkForUpdates": "检查更新",
    "menu.undo": "撤销",
    "menu.redo": "重做",
    "menu.cut": "剪切",
    "menu.copy": "复制",
    "menu.paste": "粘贴",
    "menu.pasteAndMatchStyle": "粘贴并匹配样式",
    "menu.delete": "删除",
    "menu.selectAll": "全选",
    "menu.services": "服务",
    "menu.hide": "隐藏",
    "menu.hideOthers": "隐藏其他",
    "menu.quit": "退出",
    "menu.file": "文件",
    "menu.edit": "编辑",
    "menu.view": "视图",
    "menu.window": "窗口",
    "menu.windowTitle": "窗口标题",
    "menu.showWindow": "显示窗口",
    "menu.renameWindow": "重命名窗口…",
    "menu.restoreAutoWindowTitle": "恢复自动标题",
    "menu.fullscreen": "全屏",

    // Window title
    "windowtitle.rename.title": "重命名窗口",
    "windowtitle.rename.placeholder": "输入窗口名称…",

    // Proxy
    "proxy.viewName": "API 代理",
    "proxy.title": "API 代理",
    "proxy.start": "启动",
    "proxy.stop": "停止",
    "proxy.status.running": "运行中",
    "proxy.status.stopped": "已停止",
    "proxy.port": "端口",
    "proxy.portChangeRestarts": "修改端口会重启代理。",
    "proxy.uptime": "运行时间",
    "proxy.channels": "通道",
    "proxy.copyAddress": "复制地址",
    "proxy.copyAddress.copied": "已复制",
    "proxy.serviceNotRunning": "服务未运行",
    "proxy.tab.messages": "Claude",
    "proxy.tab.responses": "Codex",
    "proxy.tab.gemini": "Gemini",
    "proxy.tab.metrics": "指标",
    "proxy.tab.history": "历史",
    "proxy.channelCount": "{count} 个通道",
    "proxy.addChannel": "添加通道",
    "proxy.addFirstChannel": "添加第一个通道",
    "proxy.noChannels": "暂无配置的通道",
    "proxy.sync.syncChannels": "同步通道",
    "proxy.sync.syncFromLocal": "从本地同步",
    "proxy.sync.confirmOverwriteRemote": "这将覆盖远程 {connection} 的代理通道配置（包含 API 密钥）。是否继续？",
    "proxy.sync.syncedAll": "已同步全部通道到 {connection}。",
    "proxy.sync.noLocalChannels": "本地未配置 {tab} 通道，请先添加通道。",
    "proxy.sync.syncedChannels": "已同步 {count} 个{tab}通道到 {connection}。",
    "proxy.dock.minimize": "最小化",
    "proxy.dock.running": "API 代理（{connection}）运行中，端口 {port}",
    "proxy.dock.stopped": "API 代理（{connection}）已停止",
    "proxy.dock.disconnected": "API 代理（{connection}）已断开",
    "proxy.dock.unknown": "API 代理（{connection}）状态不可用",
    "proxy.editChannel": "编辑通道",
    "proxy.deleteChannel": "删除通道",
    "proxy.testConnection": "测试连接",
    "proxy.latency": "延迟: {ms}ms",
    "proxy.channel.channelWithIndex": "通道 {index}",
    "proxy.channel.name": "名称",
    "proxy.channel.serviceType": "服务类型",
    "proxy.channel.baseUrl": "基础 URL",
    "proxy.channel.backupUrls": "备用 URL",
    "proxy.channel.configuredCount": "已配置 {count} 个",
    "proxy.channel.apiKeys": "API 密钥",
    "proxy.channel.apiKeysSummary": "{count} 个 - {sample}",
    "proxy.channel.apiKeysSummaryEnabled": "启用 {enabled} / 总数 {total} - {sample}",
    "proxy.channel.apiKeysAllPaused": "已配置 {total} 个（全部暂停）",
    "proxy.channel.noneConfigured": "未配置",
    "proxy.channel.priority": "优先级",
    "proxy.channel.status": "状态",
    "proxy.channel.active": "活跃",
    "proxy.channel.suspended": "已暂停",
    "proxy.channel.disabled": "已禁用",
    "proxy.channel.enableHint": "启用该通道",
    "proxy.channel.disableHint": "禁用该通道",
    "proxy.channel.modelMapping": "模型映射",
    "proxy.channel.modelMappingSummary": "{count} 条规则",
    "proxy.channel.description": "描述",
    "proxy.channel.lowQuality": "低质量通道",
    "proxy.channel.authType": "认证类型",
    "proxy.channel.authTypeDefault": "默认（根据服务类型）",
    "proxy.channel.authTypeBearer": "Bearer 令牌",
    "proxy.channel.authTypeBoth": "双重（API key + Bearer）",
    "proxy.channel.dragToReorder": "拖动排序",
    "proxy.metrics.title": "性能指标",
    "proxy.metrics.refresh": "刷新",
    "proxy.metrics.totalRequests": "总请求数",
    "proxy.metrics.successRate": "成功率",
    "proxy.metrics.successful": "成功",
    "proxy.metrics.failed": "失败",
    "proxy.metrics.requestDistribution": "请求分布",
    "proxy.metrics.successRateByChannel": "各通道成功率",
    "proxy.metrics.avgLatency": "平均延迟",
    "proxy.metrics.tokenUsage": "Token 使用量",
    "proxy.metrics.inputTokens": "输入 Token",
    "proxy.metrics.outputTokens": "输出 Token",
    "proxy.circuitBreaker.title": "熔断器状态",
    "proxy.circuitBreaker.healthy": "所有熔断器健康",
    "proxy.circuitBreaker.failures": "{count} 次连续失败",
    "proxy.circuitBreaker.reset": "重置熔断器",
    "proxy.form.basicInfo": "基本信息",
    "proxy.form.quickPick": "快速选择",
    "proxy.form.authentication": "认证",
    "proxy.form.advanced": "高级",
    "proxy.form.addApiKey": "添加 API 密钥",
    "proxy.form.addBackupUrl": "添加备用 URL",
    "proxy.form.addMapping": "添加映射",
    "proxy.form.sourceModel": "源模型",
    "proxy.form.targetModel": "目标模型",
    "proxy.form.optional": "（可选）",
    "proxy.form.channelNamePlaceholder": "通道名称",
    "proxy.form.apiKeyPlaceholder": "输入 API 密钥",
    "proxy.form.apiKeyEnable": "启用密钥",
    "proxy.form.apiKeyDisable": "暂停密钥",
    "proxy.form.descriptionPlaceholder": "通道描述（可选）",
    "proxy.form.saveChanges": "保存修改",
    "proxy.noData": "暂无数据",
    "proxy.history.loading": "正在加载历史…",
    "proxy.history.recordCount": "{count} 条记录",
    "proxy.history.retentionHint": "仅保留最近 {hours} 小时",
    "proxy.history.filterChannel": "通道：{channel}",
    "proxy.history.filterStatus.label": "状态筛选",
    "proxy.history.filterStatus.all": "全部",
    "proxy.history.filterStatus.error": "仅错误",
    "proxy.history.filterStatus.success": "仅成功",
    "proxy.history.clear": "清空",
    "proxy.history.emptyTitle": "暂无请求历史",
    "proxy.history.emptyHint": "请求产生后会显示在这里",
    "proxy.history.col.status": "状态",
    "proxy.history.col.details": "详情",
    "proxy.history.col.time": "时间",
    "proxy.history.col.type": "类型",
    "proxy.history.col.channel": "通道",
    "proxy.history.col.model": "模型",
    "proxy.history.col.tokens": "Token",
    "proxy.history.col.latency": "延迟",
    "proxy.history.filterByChannel": "按通道筛选：{channelId}",
    "proxy.history.viewErrorDetails": "查看错误详情",
    "proxy.history.detailsTitle": "错误详情",
    "proxy.history.detailsSummary": "摘要",
    "proxy.history.detailsTime": "时间",
    "proxy.history.detailsChannel": "通道",
};

function formatMessage(template: string, vars?: Record<string, string | number>): string {
    if (!vars) return template;
    return template.replace(/\{(\w+)\}/g, (_, k: string) => {
        const v = vars[k];
        return v == null ? `{${k}}` : String(v);
    });
}

export function t(lang: AppLanguage, key: I18nKey, vars?: Record<string, string | number>): string {
    const message = (lang === "zh-CN" ? zhCN[key] : en[key]) ?? en[key] ?? key;
    return formatMessage(message, vars);
}
